#!/usr/bin/env php
<?php declare(strict_types=1);

use Symfony\Component\Console\Application;
use Symfony\Component\Console\Output\ConsoleOutput;
use Symfony\Component\Console\Input\ArgvInput;
use Symfony\Component\Console\Style\SymfonyStyle;
use TomasVotruba\ShopsysAnalysis\Command\AnalyzeCommand;
use TomasVotruba\ShopsysAnalysis\Finder\PhpFilesFinder;
use TomasVotruba\ShopsysAnalysis\ProjectProvider;

require_once __DIR__ . '/../vendor/autoload.php';


// dumb DI
$input = new ArgvInput;
$output = new ConsoleOutput;
$symfonyStyle = new SymfonyStyle($input, $output);

$projectProvider = new ProjectProvider;

$phpFilesFinder = new PhpFilesFinder;

$analyzeCommand = new AnalyzeCommand($symfonyStyle, $projectProvider, $phpFilesFinder);

// setup console
$application = new Application;
$application->add($analyzeCommand);
$application->setDefaultCommand('analyze', true);

// run
$exitCode = $application->run($input, $output);
exit($exitCode);
